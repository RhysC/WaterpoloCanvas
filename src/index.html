<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Water polo Demo</title>
    <link href="./stylesheets/screen.css" media="all" rel="stylesheet" type="text/css"/>
    <script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script>
		<script language="javascript" src="javascripts/sprite.js" type="text/javascript"></script>
  </head>
  <body>
    <!-- <h1>Space Demo</h1> -->
    <script type='text/javascript'>
      //<![CDATA[
				var multiplier = 30;
				var poolWidth = 20;
				var poolLength = 30;
				var goalDepth = 0.5;
				var goalWidth = 3;
        var CANVAS_WIDTH = (poolLength * multiplier) + (goalDepth * multiplier);
        var CANVAS_HEIGHT = poolWidth * multiplier;
        var FPS = 30;//FOR animation
        
				var Goal = function(x){
					var self = this;
					self.color= "#00A";
					self.x=x;
					self.width=goalDepth*multiplier;
					self.height=goalWidth*multiplier;
					self.draw = function(){
						//console.log({x:x, y:(CANVAS_HEIGHT/2)-(self.height/2), x2:x+self.width, y2:(CANVAS_HEIGHT/2)+(self.height/2)});
						canvas.fillRect(x, (CANVAS_HEIGHT/2)-(self.height/2), self.width, self.height);
					}					
				}
				var goal1 = new Goal(0);
				var goal2 = new Goal(CANVAS_WIDTH-(goalDepth*multiplier));
				
				var positionBoundary = function(x,color){
					var self = this;
					self.x = x;
					self.color = color;
					self.draw = function(){
						canvas.beginPath();
						canvas.moveTo(self.x, 0); 
						canvas.lineTo(self.x, CANVAS_HEIGHT); 
						canvas.strokeStyle = self.color;
						canvas.stroke();
					}
				}
				
				first2Meter = new positionBoundary(2*multiplier, "#f00");
				second2Meter = new positionBoundary(28*multiplier, "#f00");
				first5Meter = new positionBoundary(5*multiplier, "#ff0");
				second5Meter = new positionBoundary(25*multiplier, "#ff0");
				halfway = new positionBoundary(15*multiplier, "#000");
				
				var Enemy = function(x,y){
					var self = this;
					self.x = x*multiplier;
					self.y = (y-0.5)*multiplier;
					self.sprite = Sprite("enemy");
          self.draw = function() {
            this.sprite.draw(canvas, self.x, self.y);
          };
				}
				var TeamMate = function(x,y){
					var self = this;
					self.x = (x-0.5)*multiplier;
					self.y = (y-0.5)*multiplier;
					self.sprite = Sprite("player");
          self.draw = function() {
            this.sprite.draw(canvas, self.x, self.y);
          };
				}
				
				var enemies = [new Enemy(2,5),new Enemy(6,7),new Enemy(8,10),new Enemy(6,14),new Enemy(2,16),new Enemy(2,10)];
				var team = [new TeamMate(2,5),new TeamMate(6,7),new TeamMate(8,10),new TeamMate(6,14),new TeamMate(2,16),new TeamMate(2,10)];
        
        //Fill of aqua make the red go to shit
        var canvasElement = $("<canvas width='" + CANVAS_WIDTH + "' height='" + CANVAS_HEIGHT + "' style='border-style: solid;border-color: aqua;'></canvas");
        var canvas = canvasElement.get(0).getContext("2d");
        canvasElement.appendTo('body');
        
        setInterval(function() {
          update();
          draw();
        }, 1000/FPS);
        
        function update() {
          //animation goes here
        }
        
        function draw() {
          canvas.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
					goal1.draw();
					goal2.draw();
				  halfway.draw();
				
					first2Meter.draw();
				  second2Meter.draw();
				  first5Meter.draw();
				  second5Meter.draw();
				 	
          //ball.draw();
          
          enemies.forEach(function(enemy) {
            enemy.draw();
          });
					
					team.forEach(function(teammate) {
            teammate.draw();
          });
					
        }        
      //]]>
    </script>
  </body>
</html>
